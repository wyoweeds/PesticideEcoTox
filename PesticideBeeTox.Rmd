---
title: "Honey bee toxicity of pesticides used in United States corn and soybean
  production, 1998 -- 2020"
author: "Andrew R. Kniss & Andrea De Stefano"
date: "DRAFT -- last updated on `r Sys.Date()`"
output:
  html_document: default
  word_document:
    reference_docx: PesticideBeeTox_Styles.docx
bibliography: references.bib
csl: "WSSA-Journals.csl"
---

------------------------------------------------------------------------

# Introduction

The use of pesticides (herbicides, insecticides, and fungicides) is pivotal for crop protection, providing farmers with an efficient tool for controlling pests, and preventing yield losses that could threaten food security [@Kudsk2018Pesticide] and cause devastating economic losses [@Popp2013Pesticide; @Tudi2021Agriculture]. Therefore, the use of pesticides has become a necessary agricultural practice, with one-third of agricultural products depending on their application [@Tudi2021Agriculture]. However, pesticide use in agriculture can have detrimental side effects on non-target organisms and ecosystems, with a very small percentage of the amount applied coming in direct contact with target pests [@Werf1996Assessing]. The increasing number of pesticides' negative effects has shaped their use in accordance with changes in agricultural and pest management strategies, regulatory policies, environmental and health hazard, and public awareness.

In the United States, the use of synthetic pesticides sha increased drastically from the 1960s to the early 1980s, then stabilized according to the change in crop acreage, the development of pesticides with lower per-acre application, and the adoption of genetically engineered (GE) insect-resistant and herbicide tolerant crops [@Osteen2013Economic; @Kniss2018Genetically]. As a reflection of US Environmental Protection Agency (US EPA) regulations, the type of synthetic insecticides applied in agriculture has changed from mainly organophosphorus and N-methyl carbamate insecticides to considerably lower quantities of organophosphorus compounds, together with a considerable increase in neonicotinoids and a small increase in pyrethroids [@DiBartolomeis2019assessment]. On the other hand, the use of herbicides seemed to be affected by the increased use of herbicide-tolerant crops, which led to a higher application rate [@Benbrook2016Trends; @Kim2022Worldwide]. Similarly, fungicide application rate is predicted to rise because of climate change, increasing of fungicide resistance, and spread of invasive fungal species [@Boxall2009Impacts; @Fisher2012Emerging].

Evaluating the risk of pesticides is a necessary and complex task that requires detailed information on active ingredients, toxicity levels, application rates, routes of exposure, effects on non-target organisms, interactions, and environmental fate [@DiBartolomeis2019assessment; @Greitens2007alternative]. Moreover, the assessment of pesticide risks is frequently based on partial information, making the determination of the overall risk of pesticide use difficult and, often times, subjective [@Greitens2007alternative; @dushoff1994; @peterson2014]. Nonetheless, scientists and agencies have developed numerous methods to evaluate the environmental risks associated with pesticides use, including pesticide risk indicators based on numerous information, such as active ingredients, use rate, acute and chronic toxicity information, environmental persistence and mobility, and non-target effects [@Greitens2007alternative; @kniss2017].

Generally, the first step in developing methods to evaluate the ecological risk of pesticides is to build a reliable database based on existing empirical toxicity data derived from literature review procedures. The ECOTOXicology Knowledgebase (ECOTOX Ver 5, www.epa.gov/ecotox) currently represents the world's largest compilation of curated ecotoxicity data, providing data for assessments of safety and ecological research for over 12,000 chemicals and ecological species with over one million test results from over 50,000 references [@Olker2022ECOTOXicology]. Managed by US-EPA, it provides transparent and comprehensive information about toxicity measures and endpoints such as $LD_{50}$, $LC_{50}$, and other sublethal effects, and effects on both aquatic and terrestrial organisms.

Among terrestrial organisms, insect pollinators are widely used for environmental risk assessment procedure and regulatory agencies, such as US-EPA and European Food Safety Agency (EFSA), require the submission of insect pollinators risk toxicity data when registering pesticides because their services to terrestrial ecosystems and crop production [@Reilly2020Crop; @farruggia2022]. Pollinators, in particular honey bees (*Apis mellifera*), are at risk for several reasons, including pesticides uses [@Goulson2015Bee]. Honey bees represent a useful indicator species because of their importance to agriculture, the availability of standardized testing for lab and field experiments [@farruggia2022], their ability to interact with pesticides through different exposure pathways [@Johnson2015Honey], and their sensitivity to pesticides with respect to other bee species [@Arena2014meta-analysis]. Therefore, honey bees represent the most well studied indicator of insect health in US agricultural lands, having the most comprehensive data set available for insect, and allowing to show how pesticide toxicity loadings have changed over time [@DiBartolomeis2019assessment].

The objective of this study is to combine honey bee toxicological endpoints with pesticide use data and crop yields to quantify (1) how the average toxicity of agricultural pesticides used in the United States has changed over time; and (2) determine how specific pesticides and pest targets contribute to the overall non-target insect risk. This information will benefit the general public by informing the debate on whether domestic agricultural systems have become more or less ecologically efficient and sustainable over time, and allow us to focus future efforts on pests and pesticides that contribute most to overall risk.

# Methods

```{r setup, include = FALSE, warning = FALSE, message = FALSE, results = 'hide'}
library("tidyverse")
library("cowplot")
library("readxl")
library("openxlsx")
library("plotly")
library("rcartocolor")
library("tidytext")
library(knitr)
opts_knit$set(eval.after = "fig.cap")

### Load Kynnetec AgroTrak pesticide data (proprietary):
AgroTrak.Timing.dat <- read_excel(
  "DATA/US AgroTrak Chemical Use Timing.xlsx",
  skip = 5) %>%
  select(Year, Crop,
         Timing0 = `Application Timing`,
         Type = `Pesticide Type`,
         Active.Ingredient = `Active Ingredient`,
         Volume.lbs = `AI volume\r\n(lb)`,
         Base.Area.Treated = `Base Area Treated\r\n(acres)`,
         Total.Area.Treated = `Total Area Treated\r\n(acres)`) %>%
  mutate(ai = str_replace_all(Active.Ingredient, " \\(.\\)", ""),
         Timing = case_when(
           Timing0 %in% c("At Planting", "Before Crop Emergence",
                          "Last Fall", "Prior to Planting") ~ "PRE",
           Timing0 %in% c("Early Post (Herbicides)", "Late Post (Herbicides)",
                          "Postemergence (Non-Herbicides)",
                          "Foliar atTasseling (Fungicides)", 
                          "Foliar before Tasseling (Fungicides)") ~ "POST"),
         Timing = factor(Timing, ordered = "TRUE",
                            levels = c("PRE", "POST"))) %>%
  group_by(Year, Crop, Timing, Type, Active.Ingredient, ai) %>%
  summarize(Volume.lbs = round(sum(Volume.lbs)),
            Base.Area.Treated = round(sum(Base.Area.Treated)),
            Total.Area.Treated = round(sum(Total.Area.Treated))) %>%
    mutate(Type = factor(Type,
                         levels = c("Insecticide", "Herbicide", "Fungicide")))
glimpse(AgroTrak.Timing.dat)

## Get full pesticide list from AgroTrak:
AgroTrak.aiList <- AgroTrak.Timing.dat %>%
  select(ai) %>%
  distinct()

### load Farruggia et al. (2022) tox data:
farruggia.s1.all <- read_excel("DATA/journal.pone.0265962.s001.xlsx",
                          sheet = "Supporting Table S1", 
                          skip = 7, 
                          col_names = c("Pesticide", "PCCODE", 
                                        "Type", "Class", "MOA", 
                                        "AAC.LD50", LETTERS[1:7])) %>%
  select(Pesticide:AAC.LD50) %>%
  mutate(ineq = ifelse(str_detect(AAC.LD50, ">"), ">", NA),
         AAC.LD50 = as.numeric(str_remove(AAC.LD50, ">")),
         ai = str_to_upper(Pesticide)) %>%
  mutate(source = "Farruggia et al. 2022") %>%
  select(ai, ineq, AAC.LD50, source)
glimpse(farruggia.s1.all)

### Load concordance file:
srcTab <- read_csv("DATA/cclistInEcotox.csv")
glimpse(srcTab)

### Load honey bee toxicity values from Ecotox export
ecotox.dat0 <- 
  read_excel("DATA/ECOTOX-Terrestrial-Export_20211207.xlsx",
             sheet = "Terrestrial-Export") %>%
  rename(cas.number = "CAS Number", chemName = "Chemical Name") %>%
  filter(`Species Scientific Name` == "Apis mellifera") %>%
  select(source, cas.number, chemName,
         Species = `Species Scientific Name`, 
         Lifestage = `Organism Lifestage`,
         ExposureType = `Exposure Type`, 
         concType = `Conc 1 Type (Author)`,
         Effect, Endpoint, ineq = `Observed Response Mean Op`,
         ObsRespMean = `Observed Response Mean`,
         ToxUnit = `Observed Response Units`,
         ObservedDuration.d = `Observed Duration (Days)`)
glimpse(ecotox.dat0)

### Join with the concordance list:
ecotox.dat1 <- ecotox.dat0 %>%
  filter(Lifestage == "Adult" &
           Endpoint == "LD50" & 
           ExposureType == "Dermal") %>%
  right_join(srcTab) %>%
  select(-inEcoTox, -inManualAdd, -ModeOfAction)
glimpse(ecotox.dat1) 

## SELECTION LOGIC for exported Ecotox data
## For ais with multiple adult acute dermal LD50 values in Ecotox:
## 1) if there is only one exact estimate use it (exclude > values)
## 2) if there are multiple exact estimates, use the lowest value
## 3) if there are no exact estimates, use the lowest > value (questionable...)
ecotox.select1 <- ecotox.dat1 %>%
  group_by(ai) %>%
  mutate(n.est = sum(is.na(ineq))) %>%
  filter(case_when(
    n.est == 1 ~ is.na(ineq), ## (1)
    n.est > 1 ~ is.na(ineq) & ObsRespMean == min(ObsRespMean), ## (2)
    n.est == 0 ~ ObsRespMean == min(ObsRespMean) ## (3)
  )) %>%
  select(ai, ineq, AAC.LD50 = ObsRespMean, source)
glimpse(ecotox.select1)

ecotox.dat2 <- left_join(ecotox.select1 %>% select(ai, 
                                                   eco.ineq = ineq,
                                                   eco.LD50 = AAC.LD50), 
                         farruggia.s1.all %>% select(ai,
                                                     far.ineq = ineq,
                                                     far.LD50 = AAC.LD50)) %>%
    mutate(same.LD50 = eco.LD50 == far.LD50,
           lower.LD50 = case_when(
           eco.LD50 - far.LD50 < 0 ~ "Ecotox",
           eco.LD50 - far.LD50 > 0 ~ "Farruggia",
           same.LD50 == TRUE ~ "Same")) %>%
    arrange(lower.LD50, eco.ineq)
glimpse(ecotox.dat2)
which.farruggia <- ecotox.dat2 %>%
  filter(lower.LD50 == "Farruggia") %>%
  select(ai)
which.farruggia

## Load manually searched tox values from PRA/ERA documents:
missingSearch.dat <- read_excel("DATA/MissingToxDataSearch.xlsx",
                                sheet = "MissingToxDataSearch",
                                range = cell_cols("A:F")) %>%
  select(ai, ineq, AAC.LD50, source)
glimpse(missingSearch.dat)

finalTox.dat <- bind_rows(
  ecotox.select1 %>% filter(!ai %in% which.farruggia$ai & 
                              !is.na(AAC.LD50)),
  farruggia.s1.all %>% filter(ai %in% which.farruggia$ai),
  missingSearch.dat %>% filter(!is.na(AAC.LD50))
) %>%
  group_by(ai) %>%
  distinct() %>%
  mutate(AAC.LD50 = ifelse(ai == "DICAMBA", 90.65, AAC.LD50),
         ineq = ifelse(ai == "DICAMBA", ">", ineq),
         source = ifelse(ai == "DICAMBA", "Ecotox Export", source)) %>%
  bind_rows(data.frame(ai = "CYANAZINE", 
                       ineq = ">", AAC.LD50 = 193.38,
                       source = "EPA communication"))
glimpse(finalTox.dat)
write_csv(finalTox.dat, "finalToxData.csv")

## USDA planted acres:
plantedAcres.dat <- read_csv("DATA/USDA-PlantedAcresProduction_1990-2022.csv") %>%
  select(Year, State, Commodity, Data.Item = `Data Item`, Value) %>%
  mutate(Data.Item = 
           str_remove(Data.Item, 
                      c("CORN - |CORN, GRAIN - |SOYBEANS - "))) %>%
  pivot_wider(id_cols = c(Year, State, Commodity),
              values_from = Value,
              names_from = Data.Item) %>%
  rename(Acres = `ACRES PLANTED`,
         productionBu = `PRODUCTION, MEASURED IN BU`,
         productionUSD = `PRODUCTION, MEASURED IN $`) %>%
  mutate(Crop = str_to_title(Commodity),
         PlantedHectares = Acres / 2.47,
         ProductionTonnes = case_when(
           Crop == "Corn" ~ round(productionBu * 56 * 0.45359 /1000),
           Crop == "Soybeans" ~ round(productionBu * 60 * 0.45359 /1000)),
         Yield.tha = round(ProductionTonnes / PlantedHectares, 2),
         ProductionBUSD = case_when(
           Crop == "Corn" ~ round(productionUSD / 10^9, 1),
           Crop == "Soybeans" ~ round(productionUSD / 10^9, 1))) %>%
  select(Year, Crop, PlantedHectares, ProductionTonnes, ProductionBUSD, Yield.tha)
glimpse(plantedAcres.dat)

## Merge with usage data
AgroTrak.ecotox <-
  AgroTrak.Timing.dat %>%
  left_join(finalTox.dat) %>%
  mutate(Year = as.numeric(Year),
         Volume.kg = round(Volume.lbs * 0.45359),
         BaseArea.ha = round(Base.Area.Treated / 2.47),
         TotalArea.ha = round(Total.Area.Treated / 2.47),
         Rate.kgha = Volume.kg / BaseArea.ha) %>%
  left_join(plantedAcres.dat) %>%
  mutate(BeeRex.EEC = (Volume.kg / BaseArea.ha) * 2.4 / AAC.LD50,
         ToxIndex.vol = Volume.kg / AAC.LD50,
         ToxIndex.rate = Rate.kgha / AAC.LD50,
         ToxIndex.area = (Volume.kg / PlantedHectares) / AAC.LD50)
glimpse(AgroTrak.ecotox)
```

## Data sources

### Pesticide usage data

Proprietary pesticide use data were obtained from the FarmTrak product maintained by [Kynetec](https://www.kynetec.com/). Data included pesticide volume applied, treated acreage, and timing of pesticide applications for corn and soybean from 1998 through 2020. Application timings from the original data were condensed into either before crop emergence (PRE) or after crop emergence (POST).

### Honey bee toxicity data

Adult acute contact $LD_{50}$ values for honey bee (*Apis mellifera*) were obtained from the following sources:

-   The U.S. EPA [ECOTOX](https://cfpub.epa.gov/ecotox/) database.
-   Supporting Table S1 from @farruggia2022.
-   Manually searching pesticide registration documents and conversations with EPA EFED personnel.

The ECOTOX database was the preferred source for all pesticide toxicity data. For each active ingredient (ai) in the Kynetec data, adult acute contact $LD_{50}$ were downloaded from ECOTOX. For many active ingredients, ECOTOX reports multiple toxicity endpoints, some are exact estimates (e.g. $LD_{50}$ = 13 ug/bee). Some estimates are listed as inequalities, where the original study was unable to quantify an exact endpoint (e.g. $LD_{50}$ \> 100 ug/bee). For active ingredients with multiple adult acute contact toxicity values reported, we used the following selection criteria to select a single toxicity value for each ai:

1)  if there was only one *exact* estimate and one or more inequality estimates the exact estimate was selected.
2)  if there were multiple exact estimates, the lowest (most toxic) value was selected.
3)  if there were no exact estimates, the lowest (most toxic) inequality was selected.

After this selection criteria was applied to the ECOTOX data, the toxicity values were compared with those published by Farruggia et al. (2022). In nearly all cases, the ECOTOX values were the same as those published by Farruggia et al. For 6 pesticides, the values reported by Farruggia et al. were lower (*i.e.* more toxic) than those selected from ECOTOX; for five of those six pesticides, the Farruggia et al. values were used to ensure we used the most conservative toxicity estimates available. One estimate from Farrugia et al (2022) was determined to be an error; dicamba adult acute contact toxicity was listed correctly in ECOTOX and so that value was used. Finally, for any ai in the Kynetec data that did not have toxicity values in ECOTOX or Farruggia et al. (2022), pesticide registration documents were searched manually to obtain honey bee adult acute contact toxicity values.

```{r, include = FALSE, warning = FALSE, message = FALSE}
missDat <- AgroTrak.ecotox %>%
  group_by(Type, ai) %>%
  summarize(totalVol = signif(sum(Volume.kg), 3),
            totalBase = signif(sum(Base.Area.Treated), 3),
            AAC.LD50 = unique(AAC.LD50)) %>%
  filter(is.na(AAC.LD50) & totalVol > 1000) %>%
  arrange(desc(totalBase)) %>%
  select(ai, Type, AAC.LD50, totalVol, totalBase) %>%
  mutate(ai = str_to_lower(ai)) %>%
  data.frame()
goodDat <- AgroTrak.ecotox %>%
  group_by(Type, ai) %>%
  summarize(AAC.LD50 = unique(AAC.LD50)) %>%
  filter(!is.na(AAC.LD50)) %>%
  select(ai, Type)
```

In total, there were `r length(missDat$ai) + length(goodDat$ai)` unique pesticides in the Kynetec database applied to either corn or soybean during 1998 to 2020. Of those, we were unable to find a reliable toxicity estimate for `r length(missDat$ai)` pesticides (Table 1). Two of those pesticides (tebupirimphos and ethalfluralin) were widely used during the study period, with total application volume of nearly 3 million kg and over 1 million kg, respectively.

```{r, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(missDat %>% select(-AAC.LD50),
             col.names = c("Active ingredient", 
                           "Pesticide type",
                           "Total volume (kg)", 
                           "Total base acres treated"),
             caption = "**Table 1. Active ingredients for which more than 1,000 kg were applied during the period 1998 -- 2020 but do not have a reliable honey bee adult acute contact $LD_{50}$.**")
```

## Honey bee Toxicity Index

```{r, include = FALSE}
ToxIndex.summary.yr <- AgroTrak.ecotox %>%
  group_by(Year, Crop, Timing, Type) %>%
  summarize(ToxIndex.vol = sum(ToxIndex.vol, na.rm = TRUE),
            ToxIndex.rate = sum(ToxIndex.rate, na.rm = TRUE),
            ToxIndex.area = sum(ToxIndex.area, na.rm = TRUE),
            Yield.tha = mean(Yield.tha, na.rm = TRUE),
            Value.BUSD = mean(ProductionBUSD, na.rm = TRUE)) %>%
  mutate(EcoEff.Y = Yield.tha / ToxIndex.area,
         EcoEff.V = Value.BUSD / ToxIndex.area)
ToxIndex.summary <- AgroTrak.ecotox %>%
  group_by(Crop, Timing, Type) %>%
  summarize(ToxIndex.vol = sum(ToxIndex.vol, na.rm = TRUE),
            ToxIndex.rate = sum(ToxIndex.rate, na.rm = TRUE),
            ToxIndex.area = sum(ToxIndex.area, na.rm = TRUE),
            Yield.tha = mean(Yield.tha, na.rm = TRUE),
            Value.BUSD = mean(ProductionBUSD, na.rm = TRUE)) %>%
  mutate(EcoEff.Y = Yield.tha / ToxIndex.area,
         EcoEff.V = Value.BUSD / ToxIndex.area) %>%
  group_by(Crop) %>% 
  mutate(cropToxIndex.vol = sum(ToxIndex.vol),
         cropToxIndex.rate = sum(ToxIndex.rate),
         cropToxIndex.area = sum(ToxIndex.area),
         cropEcoEff.Y = sum(EcoEff.Y),
         cropEcoEff.V = sum(EcoEff.V),
         cropToxIndex.volPct = signif(ToxIndex.vol / 
                                         cropToxIndex.vol*100, 2),
         cropToxIndex.ratePct = signif(ToxIndex.rate / 
                                         cropToxIndex.rate*100, 2),
         cropToxIndex.areaPct = signif(ToxIndex.area / 
                                         cropToxIndex.area*100, 2),
         cropEcoEff.Y.Pct = signif(EcoEff.Y / cropEcoEff.Y*100, 2),
         cropEcoEff.V.Pct = signif(EcoEff.V / cropEcoEff.V*100, 2))

ToxIndex.cropTotals <- ToxIndex.summary %>% 
  group_by(Crop) %>% 
  summarize(cropToxIndex.vol = unique(cropToxIndex.vol),
            cropToxIndex.rate = unique(cropToxIndex.rate),
            cropToxIndex.area = unique(cropToxIndex.area),
            cropEcoEff.Y = unique(cropEcoEff.Y),
            cropEcoEff.V = unique(cropEcoEff.V))
#ToxIndex.cropTotals

cropType.summary <- ToxIndex.summary %>% 
  group_by(Crop, Type) %>%
  summarize(cropToxIndex.volPct = sum(cropToxIndex.volPct),
            cropToxIndex.ratePct = sum(cropToxIndex.ratePct),
            cropToxIndex.areaPct = sum(cropToxIndex.areaPct))
```

Pesticide use data were separated into pesticides applied before crop emergence (PRE) and pesticides applied after crop emergence (POST). For each ai applied to each crop in each year, an an area-adjusted toxicity index (*TI*) was calculated by dividing the total pesticide volume applied in kg ($P_{vol}$) by the total planted area ($A_{plant}$) for each crop to account for year-to-year changes in hectares planted to corn and soybeans. That value was then divided by the adult acute contact $LD_{50}$ to derive the *TI*. *TI* can be interpreted as the number of honey bee acute $LD_{50}$ values applied per hectare (in billions).

$$TI = \sum_{i=1}^{N_{cyt}} (\frac{P_{vol} / A_{plant}}{LD_{50}})$$

*something here about how individual pesticide contributions were divvied up*

## Pesticide Target Toxicity Index

A pesticide target toxicity index ($TI_{pest}$) was calculated to quantify relative impact that different pest species have on the overall risk to honey bees. For each pesticide application, FarmTrak data records which pest species were listed by survey respondents as the target for the pesticide application. For each active ingredient, the volume applied targeting a particular pest was divided by the total volume of the active ingredient applied. This proportion was then multiplied by that active ingredient's proportion of the total toxicity index (*TI*).

$$TI_{pest} = \sum_{i=1}^{N_{cyt}}(P_{pest} / P_{total}) * (TI_{ai} / TI_{total})$$

## Eco-Efficiency

Eco-efficiency ($E$) was calculated for each year and application timing by dividing crop yield (ton/ha) by *TI*. $E$ can be interpreted as the tonnes of crop yield produced per honey bee $LD_{50}$ applied. Higher values of $E$ suggest greater eco-efficiency.

$$E = \frac{Y}{TI}$$

------------------------------------------------------------------------

# Results & Discussion

```{r, echo = FALSE, warning = FALSE, message = FALSE}
tisum.rate.gg <- ggplot(ToxIndex.summary, 
       aes(x = ToxIndex.rate, y = Type)) +
  facet_grid(Crop ~ Timing) + 
  geom_bar(stat = "identity",
           aes(fill = Crop)) +
  ylab(element_blank()) +
  xlab("Rate-adjusted honey bee acute toxicity index") +
  theme_minimal_grid() +
  theme(legend.position = "none")
tisum.area.gg <- ggplot(ToxIndex.summary, 
       aes(x = ToxIndex.area, y = Type)) +
  facet_grid(Crop ~ Timing) + 
  geom_bar(stat = "identity",
           aes(fill = Crop)) +
  ylab(element_blank()) +
  xlab("Area-adjusted honey bee acute toxicity index") +
  theme_minimal_grid() +
  theme(legend.position = "none",
        plot.title.position = "plot") #+
  #ggtitle("Area-adjusted Toxicity Index, 1998 - 2020")

ecoeffYsum.gg <- ggplot(ToxIndex.summary, 
       aes(x = EcoEff.Y, y = Type)) +
  facet_grid(Crop ~ Timing) + 
  geom_bar(stat = "identity",
           aes(fill = Crop)) +
  ylab(element_blank()) +
  xlab("Honey bee acute toxicity eco-efficiency") +
  theme_minimal_grid() +
  theme(legend.position = "none")
ecoeffVsum.gg <- ggplot(ToxIndex.summary, 
       aes(x = EcoEff.V, y = Type)) +
  facet_grid(Crop ~ Timing) + 
  geom_bar(stat = "identity",
           aes(fill = Crop)) +
  ylab(element_blank()) +
  xlab("Honey bee acute toxicity eco-efficiency") +
  theme_minimal_grid() +
  theme(legend.position = "none")
```

The summed honey bee *TI* over all years from 1998 through 2020 was `r round(ToxIndex.cropTotals$cropToxIndex.area[1]/ToxIndex.cropTotals$cropToxIndex.area[2], 1)`-times greater in corn compared to soybean (Figure 1). Relative risk to honey bees and many other pollinator species is expected to be lower if pesticides are applied before crop emergence, as there are fewer polinators expected to visit the field; `r cornTot <- ToxIndex.summary %>% filter(Crop == "Corn" & Timing == "PRE") %>% summarize(a = sum(cropToxIndex.areaPct)); round(cornTot[[2]])`% of the summed *TI* applied to corn was applied *before* crop emergence, whereas `r soyTot <- ToxIndex.summary %>% filter(Crop == "Soybeans" & Timing == "POST") %>% summarize(a = sum(cropToxIndex.areaPct)); round(soyTot[[2]])`% of the summed *TI* applied to soybean was applied *after* crop emergence. For both crops, a vast majority of *TI* was driven by insecticide use, as expected. In corn, insecticides were responsible for nearly `r corn.i <- cropType.summary %>% filter(Crop == "Corn" & Type == "Insecticide"); corn.i$cropToxIndex.areaPct`% of *TI*, compared to `r corn.h <- cropType.summary %>% filter(Crop == "Corn" & Type == "Herbicide"); signif(corn.h$cropToxIndex.areaPct,2)`% for herbicides, and `r corn.f <- cropType.summary %>% filter(Crop == "Corn" & Type == "Fungicide"); signif(corn.f$cropToxIndex.areaPct,2)`% for fungicides. In soybean, insecticides were responsible for `r soy.i <- cropType.summary %>% filter(Crop == "Soybeans" & Type == "Insecticide"); signif(soy.i$cropToxIndex.areaPct,2)`% of the summed *TI*, compared to `r soy.h <- cropType.summary %>% filter(Crop == "Soybeans" & Type == "Herbicide");  signif(soy.h$cropToxIndex.areaPct,2)`% for herbicides, and `r soy.f <- cropType.summary %>% filter(Crop == "Soybeans" & Type == "Fungicide"); signif(soy.f$cropToxIndex.areaPct,2)`% for fungicides. In terms of total volume applied, herbicides are more heavily used in both corn and soybean; however, because *TI* accounts both for applied volume and inherent acute toxicity, the relative toxicity of insecticides to honey bees outweighs herbicide use in this metric. Because insecticides are the primary driver of overall risk to honey bees and other polinators, we will not discuss other pesticide types (herbicides and fungicides) further.

```{r, , echo = FALSE, warning = FALSE, message = FALSE, fig.width = 8, fig.height = 3, fig.cap = "**Figure 1. Summed honey bee toxicity index applied to corn or soybean during the period 1998 through 2020 by pesticide type and application timing.**"}
tisum.area.gg
```

```{r, include = FALSE, warning = FALSE, message = FALSE}
options(scipen = 10)
knitr::kable(ToxIndex.summary %>% 
               pivot_wider(id_cols = c(Type, Timing),
                           names_from = Crop,
                           values_from = cropToxIndex.areaPct) %>%
               arrange(Timing, Type),
             caption = "**Table 2. Percentage of the total honey bee risk quotient in corn and soybean by pesticide type and application timing.**")
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
ToxIndex.summary.early <- AgroTrak.ecotox %>%
  filter(Year > 1999 & Year < 2006) %>%
  group_by(Crop, Timing, Type) %>%
  summarize(ToxIndex.area = sum(ToxIndex.area, na.rm = TRUE)/6) %>%
  ungroup() %>% group_by(Crop) %>% 
  mutate(cropToxIndex.area = sum(ToxIndex.area),
         Period = "2000 - 2005")
ToxIndex.summary.late <- AgroTrak.ecotox %>%
  filter(Year > 2014) %>%
  group_by(Crop, Timing, Type) %>%
  summarize(ToxIndex.area = sum(ToxIndex.area, na.rm = TRUE)/6) %>%
  ungroup() %>% group_by(Crop) %>% 
  mutate(cropToxIndex.area = sum(ToxIndex.area),
         Period = "2015 - 2020")
ToxIndex.evl <- bind_rows(ToxIndex.summary.early, ToxIndex.summary.late)
evl.SummaryTab <- ToxIndex.evl %>% 
               filter(Type == "Insecticide") %>%
               mutate(ToxIndex.area = signif(ToxIndex.area, 2)) %>%
               select(Crop, Period, Timing, Type, ToxIndex.area) %>%
               arrange(Crop, Type, Timing, Period) %>%
               pivot_wider(id_cols = c(Crop, Timing, Type),
                           names_from = Period,
                           values_from = ToxIndex.area) %>%
  ungroup() 
```

-------------------------------------------------

Over time, insecticide use in corn has shifted from primarily PRE applications to a mix of PRE and POST applications (Table 2). During the period 2000 to 2005, `r round(evl.SummaryTab[[1,4]]/(evl.SummaryTab[[1,4]] + evl.SummaryTab[[2,4]])*100)`% of the honey bee *TI* from insecticides was applied before crop emergence, whereas more recently, from 2015 to 2020, approximately `r round(evl.SummaryTab[[1,5]]/(evl.SummaryTab[[1,5]]+evl.SummaryTab[[2,5]])*100)`% of honey bee toxicity index was applied before crop emergence. In corn, the toxicity index applied POST has increased approximately `r round(evl.SummaryTab[[2,5]]/evl.SummaryTab[[2,4]], 1)`-fold, from `r evl.SummaryTab[[2,4]]` to `r evl.SummaryTab[[2,5]]`. In soybeans, insecticide use was not reported before 2004, suggesting very limited use in that crop (Figure 2). Since 2005, insecticide applications in soybean have been mostly applied POST, and the honey bee acute toxicity index associated with POST applications has increased `r round(evl.SummaryTab[[4,5]]/evl.SummaryTab[[4,4]])`-fold since the early 2000s.
In corn and soybean combined, during the period 2015 to 2020, approximately `r round(sum(evl.SummaryTab[5]),2)` billion honey bee $LD_{50}$s were applied annually, compared to `r round(sum(evl.SummaryTab[4]),2)` billion that were applied annually between 2000 and 2005, a reduction of `r round((sum(evl.SummaryTab[4]) - sum(evl.SummaryTab[5])) / sum(evl.SummaryTab[4]) *100)`%.


**Table 2. Area-adjusted acute toxicity index values for insecticides applied before (PRE) and after (POST) crop emergence for the periods 2000 to 2005, and from 2015 to 2020.**

```{r, echo = FALSE, message = FALSE, warning = FALSE}
knitr::kable(evl.SummaryTab)
```

```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.width = 7, fig.height = 4.5, fig.cap = "**Figure 2. Honey bee adult acute contact toxicity index for insecticides applied to corn or soybean before (PRE) or after (POST) crop emergence.**"}
ggplot(data = ToxIndex.summary.yr %>%
         filter(Type == "Insecticide"),
       aes(y = ToxIndex.area, x = Year)) +
  facet_grid(Crop ~ Timing, scales = "free_y") +
  geom_point() + 
  stat_smooth(se = FALSE, span = 0.9) +
  ylab("Honeybee acute toxicity index") +
  theme_gray(base_size = 18) +
  scale_y_continuous(limits = c(0, NA)) 
```


Two pesticides, fipronil and chlorpyrifos, were responsible for a majority of the *TI* applied PRE to corn until approximately 2010 (Figure 3A). After 2010, bifenthrin became the largest contributor to *TI* in both PRE (Figure 3B) and POST (FIgure 3C) application timings in corn. Insecticide application was relatively rare in soybean before 2004. Three insecticides, bifenthrin, chlorpyrifos, and cyhalothrin-lambda, accounted for a majority of the *TI* applied POST to soybean since 2005 (Figure 3D).


```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.width = 8, fig.height = 9, fig.cap = paste0("**Figure 3. Contribution of insecticide active ingredients to honey bee adult acute contact toxicity index applied PRE to corn (A, B), POST to corn (C), or POST to soybean (D). Panel B shows the period from 2012 to 2020 for corn PRE on a zoomed-in y-axis scale. The 'All Other Insecticides' category includes ", 100-cornPre.top7prop, "% of the total corn toxicity index applied PRE, ", 100-corn.top7prop, "% of the total corn toxicity index applied POST, and ", 100-soy.top7prop, "% of the total soybean toxicity index. **")}

cornPre.90list <- AgroTrak.ecotox %>%
  filter(Type == "Insecticide" &
           Timing == "PRE" &
           Crop == "Corn") %>%
  group_by(ai) %>%
  summarize(ToxIndex.areaSum = sum(ToxIndex.area, na.rm = TRUE)) %>%
  arrange(-ToxIndex.areaSum) %>%
  mutate(total = sum(ToxIndex.areaSum),
         ToxIndex.prop = ToxIndex.areaSum / total,
         Tox.cumsum = cumsum(ToxIndex.prop)) %>%
  slice_max(ToxIndex.prop, n = 7)
cornPre.top7prop <- round(max(cornPre.90list$Tox.cumsum), 2) * 100

cornPost.90list <- AgroTrak.ecotox %>%
  filter(Type == "Insecticide" &
           Timing == "POST" &
           Crop == "Corn") %>%
  group_by(ai) %>%
  summarize(ToxIndex.areaSum = sum(ToxIndex.area, na.rm = TRUE)) %>%
  arrange(-ToxIndex.areaSum) %>%
  mutate(total = sum(ToxIndex.areaSum),
         ToxIndex.prop = ToxIndex.areaSum / total,
         Tox.cumsum = cumsum(ToxIndex.prop)) %>%
  slice_max(ToxIndex.prop, n = 7)
corn.top7prop <- round(max(cornPost.90list$Tox.cumsum), 2) * 100

soyPost.90list <- AgroTrak.ecotox %>%
  filter(Type == "Insecticide" &
           Timing == "POST" &
           Crop == "Soybeans") %>%
  group_by(ai) %>%
  summarize(ToxIndex.areaSum = sum(ToxIndex.area, na.rm = TRUE)) %>%
  arrange(-ToxIndex.areaSum) %>%
  mutate(total = sum(ToxIndex.areaSum),
         ToxIndex.prop = ToxIndex.areaSum / total,
         Tox.cumsum = cumsum(ToxIndex.prop)) %>%
  slice_max(ToxIndex.prop, n = 7)
soy.top7prop <- round(max(soyPost.90list$Tox.cumsum), 2) * 100

cbPalette.cornPre <- c("#D55E00", "#E69F00", "#999999", "#F0E442",
                         "#56B4E9", "#009E73",  "#0072B2", "#CC79A7")
cbPalette.corn <- c("#999999", "#E69F00", "#56B4E9", "#D55E00", 
                    "#009E73", "#F0E442", "#0072B2", "#CC79A7")
cbPalette.soy <- c("#999999", "#E69F00", "#009E73", "#56B4E9", 
                   "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
aiplot.ylab <- "Honey bee acute \ntoxicity index"

cornPre.aigg <- AgroTrak.ecotox %>%
  filter(Type == "Insecticide" &
           Timing == "PRE" &
           Crop == "Corn") %>%
  mutate(aiplot = case_when(
    ai %in% cornPre.90list$ai ~ ai,
    TRUE ~ "ALL OTHER INSECTICIDES"),
    aiplot = factor(aiplot, levels = c(cornPre.90list$ai,
                                       "ALL OTHER INSECTICIDES"))) %>%
  group_by(Year, aiplot) %>%
  summarize(ToxIndex.area = sum(ToxIndex.area, na.rm = TRUE)) %>%
  ungroup() %>%
  complete(aiplot, Year, fill = list(ToxIndex.area = 0)) %>%
  ggplot(aes(x = Year, y = ToxIndex.area)) +
  geom_area(aes(fill = aiplot)) +
  scale_fill_manual(values = cbPalette.cornPre) +
  ggtitle("Corn Insecticides Applied PRE") +
  xlim(c(1998, 2020)) +
  scale_y_continuous(expand = c(0,0)) +
  ylab(aiplot.ylab) + xlab(element_blank()) +
  theme_minimal_grid() +
  theme(legend.title = element_blank()) +
  annotate("rect", xmin = 2007, xmax = Inf, 
           ymin = 0.8, ymax = Inf, fill = "white")
cornPre.inset <- cornPre.aigg +
  coord_cartesian(ylim = c(0, 0.35)) +
  ylab(element_blank()) +
  scale_x_continuous(limits = c(2012, 2020),
                     breaks = seq(2012, 2020, 4)) +
  scale_y_continuous(expand = c(0,0)) +
  #theme_minimal_grid() +
  theme(legend.position = "none",
        panel.background = element_rect(fill = "#F0F0F0")) +
  ggtitle(element_blank())
cornPre.2panel <- ggdraw(cornPre.aigg) + 
  draw_plot(cornPre.inset, .36, .25, .29, .66)


corn.aigg <- AgroTrak.ecotox %>%
  filter(Type == "Insecticide" &
           Timing == "POST" &
           Crop == "Corn") %>%
  mutate(aiplot = case_when(
    ai %in% cornPost.90list$ai ~ ai,
    TRUE ~ "ALL OTHER INSECTICIDES"),
    aiplot = factor(aiplot, levels = c(cornPost.90list$ai,
                                       "ALL OTHER INSECTICIDES"))) %>%
  group_by(Year, aiplot) %>%
  summarize(ToxIndex.area = sum(ToxIndex.area, na.rm = TRUE)) %>%
  ungroup() %>%
  complete(aiplot, Year, fill = list(ToxIndex.area = 0)) %>%
  ggplot(aes(x = Year, y = ToxIndex.area)) +
  geom_area(aes(fill = aiplot)) +
  scale_fill_manual(values = cbPalette.corn) +
  ggtitle("Corn Insecticides Applied POST") +
  xlim(c(1998, 2020)) +
  scale_y_continuous(expand = c(0,0)) +
  ylab(aiplot.ylab) + xlab(element_blank()) +
  theme_minimal_grid() +
  theme(legend.title = element_blank())
  
soy.aigg <- AgroTrak.ecotox %>%
  filter(Type == "Insecticide" &
           Timing == "POST" &
           Crop == "Soybeans") %>%
  mutate(aiplot = case_when(
    ai %in% c("BIFENTHRIN", "CHLORPYRIFOS", "CYHALOTHRIN-LAMBDA",
              "DELTAMETHRIN", "THIAMETHOXAM", "CYFLUTHRIN", "ACEPHATE") ~ ai,
    TRUE ~ "ALL OTHER INSECTICIDES"),
    aiplot = factor(aiplot, 
                    levels = c("BIFENTHRIN", "CHLORPYRIFOS", 
                               "CYHALOTHRIN-LAMBDA", "DELTAMETHRIN", 
                               "THIAMETHOXAM", "CYFLUTHRIN", "ACEPHATE",
                               "ALL OTHER INSECTICIDES"))) %>%
  group_by(Year, aiplot) %>%
  summarize(ToxIndex.area = sum(ToxIndex.area, na.rm = TRUE)) %>%
  ungroup() %>%
  complete(aiplot, Year, fill = list(ToxIndex.area = 0)) %>%
  ggplot(aes(x = Year, y = ToxIndex.area)) +
  geom_area(aes(fill = aiplot)) +
  scale_fill_manual(values = cbPalette.soy) +
  ggtitle("Soybean Insecticides Applied POST") +
  xlim(c(1998, 2020)) +
  scale_y_continuous(expand = c(0,0)) +
  ylab(aiplot.ylab) + xlab(element_blank()) +
  theme_minimal_grid() +
  theme(legend.title = element_blank())

ggdraw(plot_grid(cornPre.aigg + 
                   annotate("text", x = 2008, y = 3, label = "B", 
                            size = 5, fontface = "bold"), 
                 corn.aigg, soy.aigg,
          ncol = 1, align = "v",
          labels = LETTERS[c(1,3,4)])) + 
  draw_plot(cornPre.inset, .36, .75, .29, .2)
```

## Pesticide Target Toxicity Index

```{r, include = FALSE}
# Pest Index

## Currently only includes insects
pestList <- read_excel("DATA/PestLists.xlsx",
                       sheet = "PestList") %>%
  select(Crop, Pest, TaxonGroup, Genus)

AgroTrak.PestTiming.dat <- read_excel(
  "DATA/US AgroTrak Chemical Use Timing and Pests.xlsx",
  skip = 5) %>%
  select(Year, Crop,
         Timing0 = `Application Timing`,
         Type = `Pesticide Type`,
         Active.Ingredient = `Active Ingredient`,
         Pest = Pests,
         Volume.lbs = `AI volume\r\n(lb)`,
         Base.Area.Treated = `Base Area Treated\r\n(acres)`,
         Total.Area.Treated = `Total Area Treated\r\n(acres)`) %>%
  mutate(Year = as.numeric(Year),
         ai = str_replace_all(Active.Ingredient, " \\(.\\)", ""),
         Timing = case_when(
           Timing0 %in% c("At Planting", "Before Crop Emergence",
                          "Last Fall", "Prior to Planting") ~ "PRE",
           Timing0 %in% c("Early Post (Herbicides)", "Late Post (Herbicides)",
                          "Postemergence (Non-Herbicides)",
                          "Foliar atTasseling (Fungicides)", 
                          "Foliar before Tasseling (Fungicides)") ~ "POST"),
         Volume.kg = Volume.lbs * 0.45359,
         Treated.ha = Base.Area.Treated / 2.47,
         AppRate.kgha = Volume.kg / Treated.ha) %>%
  left_join(pestList)
glimpse(AgroTrak.PestTiming.dat)

groupToxIndex <- AgroTrak.ecotox %>%
  group_by(Year, Crop, Timing) %>%
  mutate(ToxIndex.groupSum = sum(ToxIndex.area, na.rm = TRUE),
         ToxIndex.groupProp = ToxIndex.area / ToxIndex.groupSum) %>%
  select(Year, Crop, Timing, ai, 
         ToxIndex.groupProp)
glimpse(groupToxIndex)

AgroTrak.PestToxIndex <- AgroTrak.PestTiming.dat %>%
  left_join(groupToxIndex) %>% 
  select(-Timing0) %>%
  group_by(Year, Crop, Timing, ai) %>%
  mutate(ai.pestVol = Volume.kg / sum(Volume.kg)) %>%
  select(Year, Crop, Type, ai, Timing, Pest, TaxonGroup, Genus,
         ToxIndex.groupProp, ai.pestVol) %>%
  ungroup() %>%
  mutate(pestToxIndex = ToxIndex.groupProp * ai.pestVol)
glimpse(AgroTrak.PestToxIndex)


  
insectGroups <- read_excel("DATA/TI-InsectGroups.xlsx")
PestTable <- AgroTrak.PestToxIndex %>%
  filter(Year > 2014 &
           Type == "Insecticide" & 
           TaxonGroup %in% c("Coleoptera", "Hemiptera", "Lepidoptera", 
                           "Unknown")) %>%
  left_join(insectGroups) %>%
  group_by(Crop, Timing, TaxonGroup, Pest.common) %>%
  summarize(pestToxIndex = sum(pestToxIndex, na.rm = TRUE)) %>%
  ungroup() %>% group_by(Crop, Timing, TaxonGroup) %>%
  mutate(TaxonGroup.ToxTotal = sum(pestToxIndex, na.rm = TRUE),
         TaxaPct = round(100 * (pestToxIndex / TaxonGroup.ToxTotal))) %>%
  select(-TaxonGroup.ToxTotal) %>%
  arrange(Crop, Timing, -pestToxIndex) %>%
  filter(TaxaPct >= 5 ) 
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
cornPostPestTox.summary <- AgroTrak.PestToxIndex %>%
  filter(Type == "Insecticide" & 
           Timing == "POST" &
           Crop == "Corn" &!is.na(TaxonGroup)) %>%
  group_by(Crop, Year, TaxonGroup) %>%
  summarize(pestToxIndex.sum = sum(pestToxIndex, na.rm = TRUE)) %>%
  group_by(Crop, TaxonGroup) %>%
  mutate(taxonKeep = length(!is.na(pestToxIndex.sum)) > 4) %>%
  filter(taxonKeep == TRUE)

cornPost.taxa.lm <- lm(pestToxIndex.sum ~ TaxonGroup/Year + 0,
                       data = cornPostPestTox.summary)
cornPost.lm.summary <- broom::tidy(summary(cornPost.taxa.lm)) %>%
  filter(grepl(":Year", term)) %>%
  mutate(TaxonGroup = str_remove_all(term, "TaxonGroup|:Year"),
         pval.display = case_when(
           round(p.value, 3) == 0 ~ "< 0.001",
           round(p.value, 3) >  0 ~ paste0("= ",round(p.value, 3))),
         Crop = "Corn") %>%
  arrange(p.value) %>%
  select(Crop, TaxonGroup, estimate, std.error, pval.display)
```

In corn, insect pests from the orders Coleoptera and Lepidoptera contributed most to the overall *TI* (Figure 4), followed by Hemipteran insects and spider mites (Trombidiformes). In corn, there was a decreasing trend for Coleoptera (P `r cornPost.lm.summary$pval.display[cornPost.lm.summary$TaxonGroup == "Coleoptera"]`) and Lepidoptera (P `r cornPost.lm.summary$pval.display[cornPost.lm.summary$TaxonGroup == "Lepidoptera"]`) contributions to the $TI_{pest}$ over time. Hemiptera increased in importance as a pesticide target over time (P `r cornPost.lm.summary$pval.display[cornPost.lm.summary$TaxonGroup == "Hemiptera"]`). There was an increase in the contribution of the 'Unknown' pest target category (P `r cornPost.lm.summary$pval.display[cornPost.lm.summary$TaxonGroup == "Unknown"]`), which included survey responses that did not answer the question of which pest species was being targeted. Temporal trends for other taxa were not statistically obvious in corn (Figure 4).

For PRE applications in corn since 2015, corn rootworm beetles, wireworms, and grubs were the most important Coleoptera pest targets, while cutworms of various species were the most important Lepidopteran pest. The *TI* from POST applications in corn was driven by corn rootworm beetles and Japanese beetles (Coleoptera) and stink bugs (Hemiptera), presumably due to potential for silk feeding. Aphids (Hemiptera) and cutworm species (Lepidoptera) were also important drivers of the corn *TI* from POST applications since 2015. 


```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.width = 8, fig.height = 6, fig.cap = "**Figure 4. Contribution of insect pests to the honey bee adult acute contact toxicity index; corn pesticides applied *after* crop emergence, 1998-2020.**"}

ggplot(cornPostPestTox.summary, aes(x = Year, y = pestToxIndex.sum)) +
  geom_point() + stat_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ TaxonGroup, ncol = 3) +
  ggtitle("Corn POST Insecticide Targets") +
  ylab("Total Pest Toxicity Index") +
  theme_minimal_grid() + 
  theme(panel.background = element_rect(fill = "#F5F5F5"),
        axis.text.x = element_text(size = 9)) +
  geom_text(data = cornPost.lm.summary,
            aes(x = Inf, y = 0.5, label = paste("P", pval.display)),
            hjust = 1, vjust = 1, color = "blue")
```


```{r, echo = FALSE, warning = FALSE, message = FALSE}
soyPostPestTox.summary <- AgroTrak.PestToxIndex %>%
  filter(Type == "Insecticide" & 
           Timing == "POST" &
           Crop == "Soybeans" &!is.na(TaxonGroup)) %>%
  group_by(Crop, Year, TaxonGroup) %>%
  summarize(pestToxIndex.sum = sum(pestToxIndex, na.rm = TRUE)) %>%
  group_by(Crop, TaxonGroup) %>%
  mutate(taxonKeep = length(!is.na(pestToxIndex.sum)) > 4) %>%
  filter(taxonKeep == TRUE)

soyPost.taxa.lm <- lm(pestToxIndex.sum ~ TaxonGroup/Year + 0,
                       data = soyPostPestTox.summary)
soyPost.lm.summary <- broom::tidy(summary(soyPost.taxa.lm)) %>%
  filter(grepl(":Year", term)) %>%
  mutate(TaxonGroup = str_remove_all(term, "TaxonGroup|:Year"),
         pval.display = case_when(
           round(p.value, 3) == 0 ~ "< 0.001",
           round(p.value, 3) >  0 ~ paste0("= ",round(p.value, 3))),
         Crop = "Soybean") %>%
  arrange(p.value) %>%
  select(Crop, TaxonGroup, estimate, std.error, pval.display)
```

In soybean, Hemiptera pests were the greatest contributor to the overall $TI_{pest}$, although there was a significant decrease in its contribution over time (P `r soyPost.lm.summary$pval.display[soyPost.lm.summary$TaxonGroup == "Hemiptera"]`). Stink bugs and aphid species were the greatest contributors to the *TI* among hemipteran pest species. Lepidopteran pest contribution to $TI_{pest}$ increased over time (P `r soyPost.lm.summary$pval.display[soyPost.lm.summary$TaxonGroup == "Lepidoptera"]`). Since 2015, the most important Lepidoptera were various species referred to as 'worms' (including corn earworm and boll worm), 'loopers' (cabbage and soybean), and armyworms. Leaf beetles and Japanese beetles were the most important Coleoptera pest species that contributed to the *TI* from POST applications to soybean since 2015. Similar to corn, the 'Unknown' category also increased in importance (P `r soyPost.lm.summary$pval.display[soyPost.lm.summary$TaxonGroup == "Unknown"]`) due to survey respondents not answering the question about the targeted pest(s).

```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.width = 8, fig.height = 6, fig.cap = "**Figure 5. Contribution of insect pests to the honey bee adult acute contact toxicity index; soybean pesticides applied *after* crop emergence, 1998-2020.**"}

ggplot(soyPostPestTox.summary %>%
         filter(TaxonGroup != "Hymenoptera"), 
       aes(x = Year, y = pestToxIndex.sum)) +
  geom_point() + stat_smooth(method = "lm", se = FALSE) +
  facet_wrap(~ TaxonGroup, ncol = 3) +
  ggtitle("Soybean POST Insecticide Targets") +
  ylab("Total Pest Toxicity Index") +
  theme_minimal_grid() + 
  theme(panel.background = element_rect(fill = "#F5F5F5"),
        axis.text.x = element_text(size = 9)) +
  geom_text(data = soyPost.lm.summary %>%
              filter(TaxonGroup != "Hymenoptera"),
            aes(x = Inf, y = 0.75, label = paste("P", pval.display)),
            hjust = 1, vjust = 1, color = "blue")
```

```{r, include = FALSE}
### Bifenthrin:
bifenthrin.Taxa <- AgroTrak.PestToxIndex %>%
  filter(ai == "BIFENTHRIN") %>%
  group_by(TaxonGroup) %>%
  summarize(nVal = length(unique(Year))) %>% 
  filter(nVal > 8) %>%
  select(TaxonGroup) 

AgroTrak.PestToxIndex %>%
  filter(ai == "BIFENTHRIN" & 
           Timing == "POST" &
           Crop == "Corn" &
           TaxonGroup %in% bifenthrin.Taxa$TaxonGroup) %>%
  group_by(Year, TaxonGroup) %>%
  summarize(mean.pestToxIndex = mean(pestToxIndex)) %>%
  ggplot(aes(x = Year, y = mean.pestToxIndex)) +
  geom_point() + 
  geom_smooth(method = "loess", se = FALSE, span = 1.2) +
  facet_wrap(~ TaxonGroup) +
  ylab("Pest Toxicity Index") +
  theme_minimal_grid() +
  theme(plot.title.position = "plot") +
  ggtitle("Bifenthrin applied to corn POST")

AgroTrak.PestToxIndex %>%
  filter(ai == "BIFENTHRIN" & 
           Timing == "POST" &
           Crop == "Soybeans" &
           TaxonGroup %in% bifenthrin.Taxa$TaxonGroup &
           TaxonGroup != "Diptera") %>%
  group_by(Year, TaxonGroup) %>%
  summarize(mean.pestToxIndex = mean(pestToxIndex)) %>%
  ggplot(aes(x = Year, y = mean.pestToxIndex)) +
  geom_point() + 
  geom_smooth(method = "loess", se = FALSE, span = 1.2) +
  facet_wrap(~ TaxonGroup) +
  ylab("Pest Toxicity Index") +
  theme_minimal_grid() +
  theme(plot.title.position = "plot") +
  ggtitle("Bifenthrin applied to soybean POST")
```

```{r, include = FALSE}
### Chlorpyrifos:
chlorpyrifos.Taxa <- AgroTrak.PestToxIndex %>%
  filter(ai == "CHLORPYRIFOS") %>%
  group_by(TaxonGroup) %>%
  summarize(nVal = length(unique(Year))) %>% 
  filter(nVal > 8) %>%
  select(TaxonGroup) 

AgroTrak.PestToxIndex %>%
  filter(ai == "CHLORPYRIFOS" & 
           Timing == "POST" &
           Crop == "Corn" &
           TaxonGroup %in% chlorpyrifos.Taxa$TaxonGroup) %>%
  group_by(Year, TaxonGroup) %>%
  summarize(mean.pestToxIndex = mean(pestToxIndex)) %>%
  ggplot(aes(x = Year, y = mean.pestToxIndex)) +
  geom_point() + 
  geom_smooth(method = "loess", se = FALSE, span = 1.2) +
  facet_wrap(~ TaxonGroup) +
  ylab("Pest Toxicity Index") +
  theme_minimal_grid() +
  theme(plot.title.position = "plot") +
  ggtitle("Chlorpyrifos applied to corn POST")

AgroTrak.PestToxIndex %>%
  filter(ai == "CHLORPYRIFOS" & 
           Timing == "POST" &
           Crop == "Soybeans" &
           TaxonGroup %in% chlorpyrifos.Taxa$TaxonGroup &
           TaxonGroup != "Diptera") %>%
  group_by(Year, TaxonGroup) %>%
  summarize(mean.pestToxIndex = mean(pestToxIndex)) %>%
  ggplot(aes(x = Year, y = mean.pestToxIndex)) +
  geom_point() + 
  geom_smooth(method = "loess", se = FALSE, span = 1.2) +
  facet_wrap(~ TaxonGroup) +
  ylab("Pest Toxicity Index") +
  theme_minimal_grid() +
  theme(plot.title.position = "plot") +
  ggtitle("Chlorpyrifos applied to soybean POST")
```


## Eco-efficiency

Corn production eco-efficiency for both yield (Figure 6A) and value (Figure 6B) increased substantially between 1998 through 2011. However, in 2012, a substantial drop in eco-efficiency was observed, and corn eco-efficiency remained relatively flat to decreasing through 2020. In soybean production, eco-efficiency declined slowly throughout the period 2005 through 2020 (Figures 6C; 6D). The recent declining trends in eco-efficiency suggest that the negative trend associated with POST insecticides may be outstripping yield or production value gains in corn production, at least on a national-scale. 

```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 6, fig.cap = "**Figure 6. Honeybee eco-efficiency index for insecticides applied to corn or soybean *after* crop emergence. (A) efficiency numerator is crop yield; (B) efficiency numerator is the farm value of crop production.**"}

Corn.EcoY.gg <- ToxIndex.summary.yr %>% 
  filter(Crop == "Corn", Timing == "POST" & Type == "Insecticide") %>%
  mutate(after.2011 = Year > 2011) %>%
  ggplot(aes(y = EcoEff.Y, x = Year)) +
  facet_wrap(~ Crop, scales = "free_y",
             nrow = 1) +
  geom_point() + 
  stat_smooth(se = FALSE, span = 1.2, method = "lm",
              aes(color = after.2011)) + 
  ylab("Yield Eco-Efficiency") +
  xlab(element_blank()) +
  theme_gray(base_size = 18) +
  theme(legend.position = "none") +
  scale_y_continuous(limits = c(1, NA)) + #, expand = c(0, 0)) +
  scale_x_continuous(limits = c(1998, 2020))
Corn.EcoV.gg <- ToxIndex.summary.yr %>% 
  filter(Crop == "Corn", Timing == "POST" & Type == "Insecticide") %>%
  mutate(after.2011 = Year > 2011) %>%
  ggplot(aes(y = EcoEff.V, x = Year)) +
  facet_wrap(~ Crop, scales = "free_y",
             nrow = 1) +
  geom_point() + 
  stat_smooth(se = FALSE, span = 1.2, method = "lm",
              aes(color = after.2011)) + 
  ylab("Value Eco-Efficiency") +
  xlab(element_blank()) +
  theme_gray(base_size = 18) +
  theme(legend.position = "none") +
  scale_y_continuous(limits = c(1, NA)) + #, expand = c(0, 0)) +
  scale_x_continuous(limits = c(1998, 2020))

Soy.EcoY.gg <- ToxIndex.summary.yr %>% 
  filter(Crop == "Soybeans", Timing == "POST" & Type == "Insecticide") %>%
  mutate(after.2004 = Year > 2004) %>%
  ggplot(aes(y = EcoEff.Y, x = Year)) +
  facet_wrap(~ Crop, scales = "free_y",
             nrow = 1) +
  geom_point() + 
  stat_smooth(se = FALSE, span = 1.2, method = "lm",
              aes(color = after.2004)) + 
  scale_color_manual(values = "blue") +
  ylab("Yield Eco-Efficiency") +
  xlab(element_blank()) +
  theme_gray(base_size = 18) +
  theme(legend.position = "none") +
  scale_y_continuous(limits = c(1, NA)) + #, expand = c(0, 0)) +
  scale_x_continuous(limits = c(1998, 2020))
Soy.EcoV.gg <- ToxIndex.summary.yr %>% 
  filter(Crop == "Soybeans", Timing == "POST" & Type == "Insecticide") %>%
  mutate(after.2004 = Year > 2004) %>%
  ggplot(aes(y = EcoEff.V, x = Year)) +
  facet_wrap(~ Crop, scales = "free_y",
             nrow = 1) +
  geom_point() + 
  stat_smooth(se = FALSE, span = 1.2, method = "lm",
              aes(color = after.2004)) + 
  scale_color_manual(values = "blue") +
  ylab("Value Eco-Efficiency") +
  xlab(element_blank()) +
  theme_gray(base_size = 18) +
  theme(legend.position = "none") +
  scale_y_continuous(limits = c(1, NA)) + #, expand = c(0, 0)) +
  scale_x_continuous(limits = c(1998, 2020))


plot_grid(Corn.EcoY.gg, Corn.EcoV.gg, 
          Soy.EcoY.gg,  Soy.EcoV.gg,
          nrow = 2, ncol = 2, align = "hv", labels = LETTERS)
```


```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.width = 7, fig.height = 2.5, fig.cap = "**Figure X. Chemical expenses in billion USD (A) and as a proportion of total crop production operation expenses (B).**"}

usda.exp <- read_csv("DATA/USDA-Expenses_1998-2020.csv") %>%
  select(Program, Year, Period, Geo.Level = `Geo Level`, State,
         Commodity, Data.Item = `Data Item`, 
         Domain, Category = `Domain Category`,
         Value) %>%
  filter(Category == "TYPE OF OPERATION: (CROP)")

usda.cropExp <- usda.exp %>%
  select(Year, Data.Item, Value) %>%
  pivot_wider(id_cols = Year,
              names_from = Data.Item,
              values_from = Value) %>%
  rename(ChemicalTotal = `CHEMICAL TOTALS - EXPENSE, MEASURED IN $`,
         ExpenseTotals = `EXPENSE TOTALS, PRODUCTION - EXPENSE, MEASURED IN $`,
         FertilizerTotal = 
           `FERTILIZER TOTALS, INCL LIME & SOIL CONDITIONERS - EXPENSE, MEASURED IN $`) %>%
  mutate(chemPct = ChemicalTotal / ExpenseTotals,
         fertPct = FertilizerTotal / ExpenseTotals)
  #right_join(plantedAcres.dat) %>%
  #mutate(costEff = ProductionBUSD / (ChemicalTotal/(1*10^9)))
#glimpse(usda.cropExp)

plot_grid(
ggplot(usda.cropExp, aes(y = ChemicalTotal / (10^9), x = Year)) +
  geom_point() +
  geom_smooth(se = FALSE) +
  ylab("Total chemical expenses \n(Billion USD)") +
  xlab(element_blank()) +
  ylim(c(0, NA)),
ggplot(usda.cropExp, aes(y = chemPct, x = Year)) +
  geom_point() +
  geom_smooth(se = FALSE) +
  ylab("Chemical proportion of \ntotal expenses") +
  xlab(element_blank()) +
  ylim(c(0, NA)),
labels = LETTERS)

```

------------------------------------------------------------------------

## Supplemental Information

*Supplemental Table: Pest species from taxa mentioned above as either being major contributors or having a significant trend up or down in the $TI_{pest}$. Total from years 2015 through 2020.*

```{r, echo = FALSE, message = FALSE, warning = FALSE}
knitr::kable(PestTable)
```

-------------------------------------------------------------------------

# **Literature Cited**
